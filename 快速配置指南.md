# 🚀 Firebase 快速配置指南

## 📋 第一步：创建 Firebase 项目

### 1. 访问 Firebase Console
打开浏览器，访问：https://console.firebase.google.com/

### 2. 登录 Google 账号
使用你的 Google 账号登录

### 3. 创建新项目
- 点击「添加项目」或「Create a project」
- 输入项目名称（例如：`resrv-app`）
- 点击「继续」
- **取消勾选** Google Analytics（可选，简化流程）
- 点击「创建项目」
- 等待项目创建完成（约 30 秒）

---

## 🔐 第二步：启用 Authentication

### 1. 进入 Authentication
- 在左侧菜单点击「Authentication」
- 点击「Get started」或「开始使用」

### 2. 启用 Email/Password 登录
- 点击「Sign-in method」标签页
- 找到「Email/Password」，点击
- **启用第一个开关**（Email/Password）
- 点击「Save」保存

---

## 📱 第三步：获取前端配置信息

### 1. 进入项目设置
- 点击左侧菜单的**齿轮图标**（⚙️ 项目设置）
- 或点击项目名称旁边的设置图标

### 2. 添加 Web 应用
- 向下滚动到「你的应用」部分
- 点击 **Web 图标** (`</>`)
- 输入应用昵称（例如：`Resrv Web App`）
- 点击「注册应用」

### 3. 复制配置信息
你会看到一个配置对象，类似这样：

```javascript
const firebaseConfig = {
  apiKey: "AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
  authDomain: "resrv-app.firebaseapp.com",
  projectId: "resrv-app",
  storageBucket: "resrv-app.appspot.com",
  messagingSenderId: "123456789012",
  appId: "1:123456789012:web:abcdef1234567890"
};
```

**重要：不要关闭这个页面！** 你需要复制这些值。

---

## ⚙️ 第四步：配置前端环境变量

### 1. 创建前端 .env 文件
在 `frontend` 目录下创建 `.env` 文件

### 2. 填入配置值
将第三步复制的值填入：

```env
VITE_FIREBASE_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
VITE_FIREBASE_AUTH_DOMAIN=resrv-app.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=resrv-app
VITE_FIREBASE_STORAGE_BUCKET=resrv-app.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=123456789012
VITE_FIREBASE_APP_ID=1:123456789012:web:abcdef1234567890

VITE_API_BASE=http://localhost:8000
```

**注意：** 将上面的示例值替换为你从 Firebase Console 复制的实际值！

---

## 🔑 第五步：获取后端服务账号密钥

### 1. 进入服务账号设置
- 在 Firebase Console 中，点击「项目设置」（齿轮图标）
- 切换到「服务账号」标签页

### 2. 生成新的私钥
- 点击「生成新的私钥」按钮
- 会弹出确认对话框，点击「生成密钥」
- 浏览器会自动下载一个 JSON 文件（例如：`resrv-app-firebase-adminsdk-xxxxx.json`）

### 3. 保存密钥文件
- 将下载的 JSON 文件**重命名**为：`firebase-service-account.json`
- 将文件**移动**到 `backend` 目录下

**⚠️ 重要安全提示：**
- 这个文件包含敏感信息，**永远不要**提交到 Git！
- 确保 `backend/.gitignore` 包含 `*.json` 或 `firebase-service-account.json`

---

## ⚙️ 第六步：配置后端环境变量

### 1. 创建后端 .env 文件
在 `backend` 目录下创建 `.env` 文件

### 2. 填入配置值
```env
FIREBASE_CREDENTIALS_PATH=./firebase-service-account.json
DATABASE_URL=sqlite:///./resrv.db
```

---

## ✅ 第七步：验证配置

### 1. 检查文件结构
确保你的项目结构如下：

```
Resrv/
├── frontend/
│   ├── .env                    ← 应该存在
│   └── src/
│       └── config/
│           └── firebase.js
└── backend/
    ├── .env                    ← 应该存在
    ├── firebase-service-account.json  ← 应该存在
    └── auth.py
```

### 2. 启动后端测试
```bash
cd backend
uvicorn main:app --reload
```

如果看到：
```
✅ Firebase Admin SDK 已初始化（使用服务账号文件）
```
说明配置成功！

### 3. 启动前端测试
```bash
cd frontend
npm run dev
```

打开浏览器访问 `http://localhost:5173`，应该没有 Firebase 错误。

---

## 🧪 测试完整流程

### 1. 注册新用户
- 在前端点击「注册」
- 输入姓名、Email、密码
- 点击「注册」
- 应该成功注册并自动登录

### 2. 检查 Firebase Console
- 回到 Firebase Console
- 进入「Authentication」→「Users」
- 应该能看到刚注册的用户

### 3. 测试 API
- 登录后，前端会自动调用 `/auth/me`
- 后端应该能验证 Firebase token 并返回用户信息

---

## ❌ 常见问题

### 问题 1: 前端显示 Firebase 错误
**解决：**
- 检查 `.env` 文件中的配置值是否正确
- 确认所有值都以 `VITE_` 开头
- 重启开发服务器

### 问题 2: 后端无法初始化 Firebase
**解决：**
- 检查 `firebase-service-account.json` 文件是否存在
- 确认文件路径在 `.env` 中正确设置
- 检查 JSON 文件格式是否正确

### 问题 3: 注册失败
**解决：**
- 确认 Firebase Console 中已启用 Email/Password 认证
- 检查浏览器控制台的错误信息
- 确认网络连接正常

---

## 📝 配置检查清单

完成以下检查：

- [ ] Firebase 项目已创建
- [ ] Email/Password 认证已启用
- [ ] 前端 `.env` 文件已创建并填入配置
- [ ] 后端服务账号密钥文件已下载并放在 `backend` 目录
- [ ] 后端 `.env` 文件已创建并设置路径
- [ ] 后端启动时显示 Firebase 初始化成功
- [ ] 前端启动时没有 Firebase 错误
- [ ] 可以成功注册新用户

---

## 🎉 完成！

配置完成后，你的应用就可以使用 Firebase Authentication 了！

如果遇到问题，请：
1. 检查所有配置值是否正确
2. 查看浏览器控制台和终端日志
3. 参考 `Firebase配置指南.md` 获取更详细的说明

