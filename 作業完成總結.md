# ğŸ“ Firebase Auth æ•´åˆä½œæ¥­å®Œæˆç¸½çµ

## âœ… å·²å®Œæˆçš„ä»»å‹™

### 1. å‰ç«¯ Firebase Auth æ•´åˆ

#### âœ… å®‰è£ä¾è³´
- å·²å®‰è£ `firebase` SDK åˆ°å‰ç«¯å°ˆæ¡ˆ

#### âœ… å»ºç«‹ Firebase é…ç½®
- å»ºç«‹äº† `frontend/src/config/firebase.js`
- æ”¯æ´é€éç’°å¢ƒè®Šæ•¸é…ç½® Firebase

#### âœ… ä¿®æ”¹èªè­‰ä¸Šä¸‹æ–‡
- æ›´æ–°äº† `frontend/src/context/AuthContext.jsx`
- ä½¿ç”¨ Firebase Auth é€²è¡Œä½¿ç”¨è€…è¨»å†Šå’Œç™»å…¥
- è‡ªå‹•å–å¾— Firebase ID Token ä¸¦å‚³é€åˆ°å¾Œç«¯
- ç›£è½ Firebase èªè­‰ç‹€æ…‹è®ŠåŒ–

#### âœ… æ›´æ–°ç™»å…¥/è¨»å†Šä»‹é¢
- æ›´æ–°äº† `frontend/src/components/LoginRegisterModal.jsx`
- æ”¹é€²éŒ¯èª¤è™•ç†ï¼Œæ”¯æ´ Firebase éŒ¯èª¤è¨Šæ¯
- å„ªåŒ–ä½¿ç”¨è€…é«”é©—ï¼ˆè¨»å†Šå¾Œè‡ªå‹•ç™»å…¥ï¼‰

---

### 2. å¾Œç«¯ Secured API å¯¦ä½œ

#### âœ… å®‰è£ä¾è³´
- å·²å®‰è£ `firebase-admin` SDK åˆ°å¾Œç«¯å°ˆæ¡ˆ
- æ›´æ–°äº† `backend/requirements.txt`

#### âœ… æ›´æ–°è³‡æ–™æ¨¡å‹
- ä¿®æ”¹äº† `backend/models.py`ï¼š
  - æ–°å¢ `firebase_uid` æ¬„ä½ï¼ˆå¯é¸ï¼‰
  - `password` æ¬„ä½æ”¹ç‚ºå¯é¸ï¼ˆFirebase ä½¿ç”¨è€…ä¸éœ€è¦å¯†ç¢¼ï¼‰

#### âœ… æ›´æ–°è³‡æ–™æ¨¡å¼
- ä¿®æ”¹äº† `backend/schemas.py`ï¼š
  - `RegisterIn` æ”¯æ´ `firebase_uid` å’Œå¯é¸çš„ `password`
  - `UserOut` åŒ…å« `firebase_uid` æ¬„ä½

#### âœ… å¯¦ä½œ Firebase JWT é©—è­‰
- å®Œå…¨é‡å¯«äº† `backend/auth.py`ï¼š
  - åˆå§‹åŒ– Firebase Admin SDK
  - `current_user` å‡½æ•¸é©—è­‰ Firebase JWT token
  - æ”¯æ´è‡ªå‹•å»ºç«‹/åŒæ­¥ä½¿ç”¨è€…åˆ°è³‡æ–™åº«
  - ä¿ç•™å‚³çµ± JWT é©—è­‰ä½œç‚ºå¾Œå‚™

#### âœ… æ›´æ–° API è·¯ç”±
- `/auth/register` - æ”¯æ´ Firebase å’Œå‚³çµ±è¨»å†Š
- `/auth/login` - ä¿ç•™å‚³çµ±ç™»å…¥ï¼ˆå¾Œå‚™ï¼‰
- `/auth/me` - ä½¿ç”¨ Firebase JWT é©—è­‰ä¿è­·

---

## ğŸ”„ å·¥ä½œæµç¨‹

### ä½¿ç”¨è€…è¨»å†Šæµç¨‹
1. ä½¿ç”¨è€…åœ¨å‰ç«¯è¼¸å…¥å§“åã€Emailã€å¯†ç¢¼
2. å‰ç«¯ä½¿ç”¨ Firebase Auth å»ºç«‹ä½¿ç”¨è€…å¸³è™Ÿ
3. Firebase å›å‚³ä½¿ç”¨è€…æ†‘è­‰
4. å‰ç«¯å–å¾— Firebase ID Token
5. å‰ç«¯å‘¼å«å¾Œç«¯ `/auth/register` åŒæ­¥ä½¿ç”¨è€…è³‡è¨Šåˆ°è³‡æ–™åº«
6. å¾Œç«¯é©—è­‰ Firebase token ä¸¦å»ºç«‹/æ›´æ–°ä½¿ç”¨è€…è¨˜éŒ„

### ä½¿ç”¨è€…ç™»å…¥æµç¨‹
1. ä½¿ç”¨è€…åœ¨å‰ç«¯è¼¸å…¥ Email å’Œå¯†ç¢¼
2. å‰ç«¯ä½¿ç”¨ Firebase Auth ç™»å…¥
3. Firebase é©—è­‰æˆåŠŸï¼Œå›å‚³ä½¿ç”¨è€…æ†‘è­‰
4. å‰ç«¯å–å¾— Firebase ID Token
5. å‰ç«¯å°‡ Token å„²å­˜åˆ° localStorage
6. å‰ç«¯å‘¼å«å¾Œç«¯ `/auth/me` å–å¾—ä½¿ç”¨è€…è³‡è¨Š
7. å¾Œç«¯é©—è­‰ Firebase JWT token ä¸¦å›å‚³ä½¿ç”¨è€…è³‡è¨Š

### API ä¿è­·æµç¨‹
1. å‰ç«¯å‚³é€è«‹æ±‚æ™‚ï¼Œè‡ªå‹•åœ¨ Header ä¸­åŒ…å« Firebase ID Token
2. å¾Œç«¯ `current_user` ä¾è³´å‡½æ•¸é©—è­‰ Token
3. å¦‚æœé©—è­‰æˆåŠŸï¼Œå›å‚³ä½¿ç”¨è€…ç‰©ä»¶
4. å¦‚æœé©—è­‰å¤±æ•—ï¼Œå›å‚³ 401 æœªæˆæ¬ŠéŒ¯èª¤

---

## ğŸ“ ä¿®æ”¹çš„æª”æ¡ˆ

### å‰ç«¯æª”æ¡ˆ
- âœ… `frontend/package.json` - æ–°å¢ firebase ä¾è³´
- âœ… `frontend/src/config/firebase.js` - **æ–°å»º** Firebase é…ç½®
- âœ… `frontend/src/context/AuthContext.jsx` - æ•´åˆ Firebase Auth
- âœ… `frontend/src/components/LoginRegisterModal.jsx` - æ”¹é€²éŒ¯èª¤è™•ç†

### å¾Œç«¯æª”æ¡ˆ
- âœ… `backend/requirements.txt` - æ–°å¢ firebase-admin
- âœ… `backend/models.py` - æ–°å¢ firebase_uid æ¬„ä½
- âœ… `backend/schemas.py` - æ›´æ–°è³‡æ–™æ¨¡å¼
- âœ… `backend/auth.py` - å¯¦ä½œ Firebase JWT é©—è­‰

### æ–‡ä»¶æª”æ¡ˆ
- âœ… `Firebaseé…ç½®æŒ‡å—.md` - **æ–°å»º** è©³ç´°é…ç½®èªªæ˜
- âœ… `ä½œæ¥­å®Œæˆç¸½çµ.md` - **æ–°å»º** æœ¬æª”æ¡ˆ

---

## ğŸš€ ä¸‹ä¸€æ­¥æ“ä½œ

### 1. é…ç½® Firebase å°ˆæ¡ˆ
æŒ‰ç…§ `Firebaseé…ç½®æŒ‡å—.md` ä¸­çš„æ­¥é©Ÿï¼š
1. å»ºç«‹ Firebase å°ˆæ¡ˆ
2. å•Ÿç”¨ Email/Password èªè­‰
3. å–å¾—å‰ç«¯é…ç½®è³‡è¨Š
4. é…ç½®å¾Œç«¯æœå‹™å¸³è™Ÿ

### 2. è¨­å®šç’°å¢ƒè®Šæ•¸

**å‰ç«¯** (`frontend/.env`):
```env
VITE_FIREBASE_API_KEY=ä½ çš„-api-key
VITE_FIREBASE_AUTH_DOMAIN=ä½ çš„å°ˆæ¡ˆ.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=ä½ çš„å°ˆæ¡ˆ-id
VITE_FIREBASE_STORAGE_BUCKET=ä½ çš„å°ˆæ¡ˆ.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=ä½ çš„-sender-id
VITE_FIREBASE_APP_ID=ä½ çš„-app-id
VITE_API_BASE=http://localhost:8000
```

**å¾Œç«¯** (`backend/.env`):
```env
FIREBASE_CREDENTIALS_PATH=./firebase-service-account.json
DATABASE_URL=sqlite:///./resrv.db
SECRET_KEY=your-secret-key-here
```

### 3. å•Ÿå‹•æ‡‰ç”¨

**å•Ÿå‹•å¾Œç«¯**:
```bash
cd backend
uvicorn main:app --reload
```

**å•Ÿå‹•å‰ç«¯**:
```bash
cd frontend
npm run dev
```

### 4. æ¸¬è©¦åŠŸèƒ½
1. è¨ªå• http://localhost:5173
2. å˜—è©¦è¨»å†Šæ–°ä½¿ç”¨è€…
3. å˜—è©¦ç™»å…¥
4. é©—è­‰ API ä¿è­·æ˜¯å¦æ­£å¸¸å·¥ä½œ

---

## ğŸ” å®‰å…¨ç‰¹æ€§

1. **Firebase JWT é©—è­‰**ï¼š
   - æ‰€æœ‰ API è«‹æ±‚éƒ½éœ€è¦æœ‰æ•ˆçš„ Firebase ID Token
   - Token ç”± Firebase ç°½åï¼Œå¾Œç«¯é©—è­‰å…¶çœŸå¯¦æ€§

2. **è‡ªå‹•ä½¿ç”¨è€…åŒæ­¥**ï¼š
   - é¦–æ¬¡ç™»å…¥æ™‚è‡ªå‹•åœ¨è³‡æ–™åº«ä¸­å»ºç«‹ä½¿ç”¨è€…è¨˜éŒ„
   - ä¿æŒ Firebase å’Œè³‡æ–™åº«ä½¿ç”¨è€…è³‡è¨ŠåŒæ­¥

3. **å‘å¾Œç›¸å®¹**ï¼š
   - ä¿ç•™å‚³çµ± JWT èªè­‰ä½œç‚ºå¾Œå‚™
   - æ”¯æ´ç¾æœ‰ä½¿ç”¨è€…ç¹¼çºŒä½¿ç”¨å‚³çµ±æ–¹å¼ç™»å…¥

---

## ğŸ“š æŠ€è¡“æ£§

- **å‰ç«¯**ï¼š
  - React 18
  - Firebase SDK (Authentication)
  - Vite

- **å¾Œç«¯**ï¼š
  - FastAPI
  - Firebase Admin SDK
  - SQLAlchemy
  - SQLite/PostgreSQL

---

## âœ¨ ä¸»è¦æ”¹é€²

1. **ä½¿ç”¨è€…é«”é©—**ï¼š
   - è¨»å†Šå¾Œè‡ªå‹•ç™»å…¥
   - æ›´å¥½çš„éŒ¯èª¤æç¤ºï¼ˆç¹é«”ä¸­æ–‡ï¼‰
   - è‡ªå‹•ç‹€æ…‹åŒæ­¥

2. **å®‰å…¨æ€§**ï¼š
   - ä½¿ç”¨ Firebase å®˜æ–¹èªè­‰æœå‹™
   - JWT token é©—è­‰
   - å®‰å…¨çš„å¯†ç¢¼è™•ç†

3. **å¯ç¶­è­·æ€§**ï¼š
   - æ¸…æ™°çš„ç¨‹å¼ç¢¼çµæ§‹
   - è©³ç´°çš„é…ç½®æ–‡ä»¶
   - éŒ¯èª¤è™•ç†å®Œå–„

---

## ğŸ“ ä½œæ¥­è¦æ±‚å°ç…§

### âœ… è¦æ±‚ 1: çµåˆ Firebase çš„ Authï¼Œå°‡æœŸä¸­å°ˆé¡Œå‰ç«¯åŠ å…¥ç™»å…¥/è¨»å†Šç•«é¢
- âœ… å·²æ•´åˆ Firebase Authentication
- âœ… å‰ç«¯å·²æœ‰ç™»å…¥/è¨»å†Šä»‹é¢ï¼ˆLoginRegisterModalï¼‰
- âœ… ä½¿ç”¨ Firebase Auth é€²è¡Œä½¿ç”¨è€…èªè­‰
- âœ… è‡ªå‹•å–å¾—å’Œå‚³é€ Firebase ID Token

### âœ… è¦æ±‚ 2: çµåˆ Firebase çš„ Auth JWTï¼Œå°‡æœŸä¸­å°ˆé¡Œçš„ API æ”¹ç‚º Secured API
- âœ… å¾Œç«¯ä½¿ç”¨ Firebase Admin SDK é©—è­‰ JWT token
- âœ… æ‰€æœ‰éœ€è¦èªè­‰çš„ API éƒ½å—åˆ°ä¿è­·
- âœ… `current_user` ä¾è³´å‡½æ•¸é©—è­‰ Firebase token
- âœ… æœªæˆæ¬Šè«‹æ±‚å›å‚³ 401 éŒ¯èª¤

---

## ğŸ“ æ³¨æ„äº‹é …

1. **è³‡æ–™åº«é·ç§»**ï¼š
   - å¦‚æœå·²æœ‰ä½¿ç”¨è€…è³‡æ–™ï¼Œéœ€è¦åŸ·è¡Œè³‡æ–™åº«é·ç§»
   - æ–°æ¬„ä½ `firebase_uid` æ˜¯å¯é¸çš„ï¼Œä¸æœƒå½±éŸ¿ç¾æœ‰è³‡æ–™

2. **ç’°å¢ƒè®Šæ•¸**ï¼š
   - ç¢ºä¿æ‰€æœ‰ç’°å¢ƒè®Šæ•¸éƒ½å·²æ­£ç¢ºè¨­å®š
   - ä¸è¦å°‡æ•æ„Ÿè³‡è¨Šæäº¤åˆ° Git

3. **Firebase é…ç½®**ï¼š
   - ç¢ºä¿ Firebase å°ˆæ¡ˆå·²å•Ÿç”¨ Email/Password èªè­‰
   - æœå‹™å¸³è™Ÿé‡‘é‘°æª”æ¡ˆè¦å¦¥å–„ä¿ç®¡

---

## ğŸ‰ å®Œæˆï¼

æ‰€æœ‰ä½œæ¥­è¦æ±‚å·²å®Œæˆã€‚è«‹æŒ‰ç…§ `Firebaseé…ç½®æŒ‡å—.md` å®Œæˆ Firebase å°ˆæ¡ˆé…ç½®ï¼Œç„¶å¾Œå°±å¯ä»¥æ¸¬è©¦å®Œæ•´çš„èªè­‰æµç¨‹äº†ï¼

å¦‚æœ‰ä»»ä½•å•é¡Œï¼Œè«‹åƒè€ƒï¼š
- `Firebaseé…ç½®æŒ‡å—.md` - è©³ç´°é…ç½®æ­¥é©Ÿ
- `å•Ÿå‹•æŒ‡å—.md` - å¦‚ä½•å•Ÿå‹•æ‡‰ç”¨
- Firebase Console - æŸ¥çœ‹ä½¿ç”¨è€…å’Œé…ç½®

